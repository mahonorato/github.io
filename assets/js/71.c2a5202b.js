(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{395:function(e,t,s){"use strict";s.r(t);var a=s(42),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"nfs-network-file-system"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nfs-network-file-system"}},[e._v("#")]),e._v(" NFS - Network File System")]),e._v(" "),s("p",[e._v("O NFS é um sistema de arquivos distribuídos que possibilita o compartilhamanento de arquivos e diretórios entre computadores ligados em rede.")]),e._v(" "),s("p",[e._v("Com o NFS, trabalhamos com pastas e arquivos de outros computadores como se as mesmas estivessem alojadas nos discos de nossa própria máquina. Para tal, o NFS deve estar instalado tanto no computador de vai compartilhar as pastas e arquivos ("),s("strong",[e._v("SERVIDOR")]),e._v("), como o que vai que acessá-los ("),s("strong",[e._v("CLIENTE")]),e._v(").")]),e._v(" "),s("p",[e._v("Em boa parte das distribuições atuais, o serviço NFS já vem habilitado tornando a configuração do compartilhamento mais simples. Neste roteiro, no entanto, faremos a instalação desde o início.")]),e._v(" "),s("h2",{attrs:{id:"instalando-no-servidor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#instalando-no-servidor"}},[e._v("#")]),e._v(" Instalando no Servidor")]),e._v(" "),s("p",[e._v("A instalação na máquina que vai compartilhar as pastas, o "),s("strong",[e._v("SERVIDOR")]),e._v(" consiste em:")]),e._v(" "),s("ol",[s("li",[e._v("Instalar o NFS (no Fedora e CentOS)")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("sudo yum install nfs-utils -y\nchmod -R 777 /home/public\nchown nfsnobody:nfsnobody /home/public\n")])])]),s("ol",[s("li",[e._v("Criar directório para partilha")])]),e._v(" "),s("p",[e._v("mkdir /home/public")]),e._v(" "),s("ol",[s("li",[e._v("Definir permissões")])]),e._v(" "),s("p",[e._v("chmod -R 777 /home/public\nchown nfsnobody:nfsnobody /home/public")]),e._v(" "),s("ol",[s("li",[e._v("Indicar quais as máquinas que têm acesso à partilha")])]),e._v(" "),s("p",[e._v("sudo vim /etc/exports")]),e._v(" "),s("h1",{attrs:{id:"partilha-leitura-e-escrita-rw-do-directorio-home-public-para-as-maquinas-da-rede-192-168-10-0-24"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#partilha-leitura-e-escrita-rw-do-directorio-home-public-para-as-maquinas-da-rede-192-168-10-0-24"}},[e._v("#")]),e._v(" partilha (leitura e escrita rw) do directório /home/public para as máquinas da rede 192.168.10.0/24")]),e._v(" "),s("p",[e._v("e acrescentar")]),e._v(" "),s("p",[e._v("/home/public 192.168.10.0/255.255.255.0(rw)")]),e._v(" "),s("p",[e._v("Depois de realizada a configuração, vamos activar a exportação usando o comando\nsudo exports –a")]),e._v(" "),s("p",[e._v("Iniciar e acrescentar ao arranque os seguintes serviços")]),e._v(" "),s("p",[e._v("sudo systemctl enable rpcbind\nsudo systemctl enable nfs-server\nsudo systemctl enable nfs-lock\nsudo systemctl enable nfs-idmap\nsudo systemctl start rpcbind\nsudo systemctl start nfs-server\nsudo systemctl start nfs-lock\nsudo systemctl start nfs-idmap")]),e._v(" "),s("p",[e._v("S service:")]),e._v(" "),s("p",[e._v("systemctl restart nfs-server")]),e._v(" "),s("p",[e._v("Again we need to add the NFS service override in CentOS 7 firewall-cmd public zone service as:")]),e._v(" "),s("p",[e._v("sudo firewall-cmd --permanent --zone=public --add-service=nfs\nsudo firewall-cmd --permanent --zone=public --add-service=mountd\nsudo firewall-cmd --permanent --zone=public --add-service=rpc-bind\nsudo firewall-cmd --reload")]),e._v(" "),s("p",[e._v("CLIENTE")]),e._v(" "),s("p",[e._v("Do lado do cliente, apenas é necessário instalar alguns utilitários do NFS através do comando:")]),e._v(" "),s("p",[e._v("sudo yum install nfs-utils -y")]),e._v(" "),s("p",[e._v("Finally, start the NF\nEm seguida criamos um directório para montar o sistema de ficheiros paratilhado do servidor")]),e._v(" "),s("p",[e._v("mkdir /mnt/nfs/ikana_public")]),e._v(" "),s("p",[e._v("Por fim basta mapear o directório do servidor no directório do cliente. Considerando que o servidor tem associado o IP: 192.168.10.254, bastaria usar o comando:")]),e._v(" "),s("p",[e._v("mount –t nfs 192.168.10.254:/home/public /home/public")]),e._v(" "),s("p",[e._v("mount -t nfs 192.168.10.65:/home/public /mnt/nfs/ikana_public")]),e._v(" "),s("p",[e._v("E está feito. Este pequeno tutorial teve como principal objectivo dar uma ideia das potencialidades do NFS. Existem muitas outras configurações que podem ser realizadas de acordo com o cenário a implementar.")]),e._v(" "),s("p",[e._v("NFS Server and Client Installation on CentOS 7\nOn this page")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("1 Preliminary Note\n2 At NFS server end\n3 NFS client end\n4 Permanent NFS mounting\n5 Links\n")])])]),s("p",[e._v("This guide explains how to configure an NFS server on CentOS 7. Network File System (NFS) is a popular distributed filesystem protocol that enables users to mount remote directories on their server. NFS lets you leverage storage space in a different location and allows you to write onto the same space from multiple servers or clients in an effortless manner. It, thus, works fairly well for directories that users need to access frequently. This tutorial explains the process of mounting an NFS share on a CentOS 7.6 server in simple and easy-to-follow steps.\n1 Preliminary Note")]),e._v(" "),s("p",[e._v("I have fresh installed CentOS 7 server, on which I am going to install the NFS server. My CentOS server have hostname server1.example.com and IP as 192.168.0.100")]),e._v(" "),s("p",[e._v("If you don't have a CentOS server installed yet, use this tutorial for the basic operating system installation. Additionally to the server, we need a CentOS 7 client machine, this can be either a server or desktop system. In my case, I will use a CentOS 7 desktop with hostname  client1.example.com and IP  192.168.0.101 as a client. I will run all the commands in this tutorial as the root user.\n2 At NFS server end")]),e._v(" "),s("p",[e._v("As the first step, we will install these packages on the CentOS server with yum:")]),e._v(" "),s("p",[e._v("yum install nfs-utils")]),e._v(" "),s("p",[e._v("Now create the directory that will be shared by NFS:")]),e._v(" "),s("p",[e._v("mkdir /var/nfsshare")]),e._v(" "),s("p",[e._v("Change the permissions of the folder as follows:")]),e._v(" "),s("p",[e._v("chmod -R 755 /var/nfsshare\nchown nfsnobody:nfsnobody /var/nfsshare")]),e._v(" "),s("p",[e._v("We use /var/nfsshare as a shared folder, if we use another drive such as the /home directory, then the permission changes will cause a massive permissions problem and ruin the whole hierarchy. So in case, we want to share the /home directory then permissions must not be changed.\nNext, we need to start the services and enable them to be started at boot time.")]),e._v(" "),s("p",[e._v("systemctl enable rpcbind\nsystemctl enable nfs-server\nsystemctl enable nfs-lock\nsystemctl enable nfs-idmap\nsystemctl start rpcbind\nsystemctl start nfs-server\nsystemctl start nfs-lock\nsystemctl start nfs-idmap")]),e._v(" "),s("p",[e._v("Now we will share the NFS directory over the network a follows:")]),e._v(" "),s("p",[e._v("nano /etc/exports")]),e._v(" "),s("p",[e._v("We will make two sharing points  /home and /var/nfsshare. Edit the exports file as follows:")]),e._v(" "),s("p",[e._v("/var/nfsshare    192.168.0.101(rw,sync,no_root_squash,no_all_squash)\n/home            192.168.0.101(rw,sync,no_root_squash,no_all_squash)")]),e._v(" "),s("p",[e._v('Note 192.168.0.101 is the IP of the client machine, if you wish that any other client should access it you need to add it IP wise otherwise you can add "*" instead of IP for all IP access.')]),e._v(" "),s("p",[e._v("Condition is that it must be pingable at both ends.")]),e._v(" "),s("p",[e._v("Finally, start the NFS service:")]),e._v(" "),s("p",[e._v("systemctl restart nfs-server")]),e._v(" "),s("p",[e._v("Again we need to add the NFS service override in CentOS 7 firewall-cmd public zone service as:")]),e._v(" "),s("p",[e._v("firewall-cmd --permanent --zone=public --add-service=nfs\nfirewall-cmd --permanent --zone=public --add-service=mountd\nfirewall-cmd --permanent --zone=public --add-service=rpc-bind\nfirewall-cmd --reload")]),e._v(" "),s("p",[e._v("Note: If it will be not done, then it will give error for Connection Time Out at client side.")]),e._v(" "),s("p",[e._v("Now we are ready with the NFS server part.\n3 NFS client end")]),e._v(" "),s("p",[e._v("In my case, I have a CentOS 7 desktop as client. Other CentOS versions will also work the same way. Install the nfs-utild package as follows:")]),e._v(" "),s("p",[e._v("yum install nfs-utils")]),e._v(" "),s("p",[e._v("Now create the NFS directory mount points:")]),e._v(" "),s("p",[e._v("mkdir -p /mnt/nfs/home\nmkdir -p /mnt/nfs/var/nfsshare")]),e._v(" "),s("p",[e._v("Next, we will mount the NFS shared home directory in the client machine as shown below:")]),e._v(" "),s("p",[e._v("mount -t nfs 192.168.0.100:/home /mnt/nfs/home/")]),e._v(" "),s("p",[e._v("It will mount /home of NFS server. Next we will mount the /var/nfsshare directory:")]),e._v(" "),s("p",[e._v("mount -t nfs 192.168.0.100:/var/nfsshare /mnt/nfs/var/nfsshare/")]),e._v(" "),s("p",[e._v("Now we are connected with the NFS share, we will crosscheck it as follows:")]),e._v(" "),s("p",[e._v("df -kh")]),e._v(" "),s("p",[e._v("[root@client1 ~]# df -kh\nFilesystem                    Size  Used Avail Use% Mounted on\n/dev/mapper/centos-root        39G  1.1G   38G   3% /\ndevtmpfs                      488M     0  488M   0% /dev\ntmpfs                         494M     0  494M   0% /dev/shm\ntmpfs                         494M  6.7M  487M   2% /run\ntmpfs                         494M     0  494M   0% /sys/fs/cgroup\n/dev/mapper/centos-home        19G   33M   19G   1% /home\n/dev/sda1                     497M  126M  372M  26% /boot\n192.168.0.100:/var/nfsshare   39G  980M   38G   3% /mnt/nfs/var/nfsshare\n192.168.0.100:/home           19G   33M   19G   1% /mnt/nfs/home\n[root@client1 ~]#")]),e._v(" "),s("p",[e._v("So we are connected with the NFS share.")]),e._v(" "),s("p",[e._v("Now we will check the read/write permissions in the shared path. At client enter the command:")]),e._v(" "),s("p",[e._v("touch /mnt/nfs/var/nfsshare/test_nfs")]),e._v(" "),s("p",[e._v("So we successfully configured an NFS-share.\n4 Permanent NFS mounting")]),e._v(" "),s("p",[e._v("We have to re-mount the NFS share at the client after every reboot. Here are the steps to mount it permanently by adding the NFS-share in /etc/fstab file of client machine:")]),e._v(" "),s("p",[e._v("nano /etc/fstab")]),e._v(" "),s("p",[e._v("Add the entries like this:")]),e._v(" "),s("p",[e._v("[...]\n192.168.0.100:/home    /mnt/nfs/home   nfs defaults 0 0\n192.168.0.100:/var/nfsshare    /mnt/nfs/var/nfsshare   nfs defaults 0 0")]),e._v(" "),s("p",[e._v("Note 192.168.0.100 is the server NFS-share  IP address, it will vary in your case.")]),e._v(" "),s("p",[e._v("This will make the permanent mount of the NFS-share. Now you can reboot the machine and mount points will be permanent even after the reboot.")]),e._v(" "),s("p",[e._v("Cheers, now we have a successfully configured NFS-server over CentOS 7 😃")]),e._v(" "),s("p",[e._v("5 Links")]),e._v(" "),s("p",[e._v("CentOS - "),s("a",{attrs:{href:"http://www.centos.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("The CentOS Projec"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("HowtoForge - "),s("a",{attrs:{href:"https://www.howtoforge.com/nfs-server-and-client-on-centos-7",target:"_blank",rel:"noopener noreferrer"}},[e._v("NFS Server and Client Installation on CentOS 7"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("Pplware - "),s("a",{attrs:{href:"https://pplware.sapo.pt/linux/configuracao-de-um-servidor-e-cliente-nfs-no-centos-7/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Configuração de um servidor e cliente NFS no CentOS 7"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("Wikipedia - "),s("a",{attrs:{href:"https://pt.wikipedia.org/wiki/Network_File_System",target:"_blank",rel:"noopener noreferrer"}},[e._v("NFS"),s("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=n.exports}}]);