(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{400:function(o,a,e){"use strict";e.r(a);var s=e(42),t=Object(s.a)({},(function(){var o=this,a=o.$createElement,e=o._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":o.$parent.slotKey}},[e("h2",{attrs:{id:"usando-volumes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#usando-volumes"}},[o._v("#")]),o._v(" Usando Volumes")]),o._v(" "),e("p",[o._v("O container possui seu próprio sistemas de pastas para organização dos arquivos. Estas pastas, no entanto, não são visíveis para a máquina hospedeira (host). E o pior: quando o container é extinto, os dados que estavam nestas pastas se perdem também. A maneira de preservar os dados é adicionar pastas externas ao container, mapeando-as como se fossem nativas. E para tal usamos os "),e("strong",[o._v("volumes")]),o._v(".")]),o._v(" "),e("p",[o._v("Os volumes são versáteis e adiciona novas possibilidades ao ambiente criado por um container:")]),o._v(" "),e("ul",[e("li",[o._v("Ao excluirmos o container, o volume permanece inalterado, preservando os dados, arquivos de parametros, etc.;")]),o._v(" "),e("li",[o._v("É possível compartilhar um mesmo volume entre containêres, deixando os dados visíveis para ambos;")]),o._v(" "),e("li",[o._v("Um volume pode estar localizado em uma outra máquina, na rede local ou em nuvem;")]),o._v(" "),e("li",[o._v("Um volume pode ser acoplado e desacplado ao container.")])]),o._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[o._v("TIP")]),o._v(" "),e("p",[o._v("Para situações mais imediatas é possível conectar uma pasta local em um container com o comando "),e("em",[o._v("-v")]),o._v(" ou com "),e("em",[o._v("--mount type=bind")])])]),o._v(" "),e("h2",{attrs:{id:"conectando-uma-pasta-ao-iniciar-o-container"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#conectando-uma-pasta-ao-iniciar-o-container"}},[o._v("#")]),o._v(" Conectando uma pasta ao iniciar o container")]),o._v(" "),e("p",[o._v("Para ligar um volume basta usar o parametro "),e("em",[o._v("v")]),o._v(" e informar a localização da pasta no servidor, separar por "),e("em",[o._v(":")]),o._v(" e informar a pasta no container. As pastas serão criadas, caso não existam e substituídas, caso já exista no container")]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("sudo docker run -v /pasta/pasta_hospedeiro:/pasta_container --name=nome-container -it nome_imagem [comando_container]\n")])])]),e("p",[o._v("Ou para ficar mais legível:")]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("sudo docker run -v /pasta/pasta_hospedeiro:/pasta_container \\\n                 --name=nome-container \\\n                 -it nome_imagem [comando_container]\n")])])]),e("p",[o._v("Exemplo:")]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("sudo docker run -v /tmp/pasta_hospedeiro:/pasta_container  \\\n                 --name=alpine_sandbox-06 \\\n                 -it alpine /bin/ash\n\n\n[marcos@localhost ~]$ sudo docker run -v /tmp/pasta_hospedeiro:/pasta_container  \\\n>                  --name=alpine_sandbox-06 \\\n>                  -it alpine /bin/ash\n/ # ls\nbin  etc   lib     mnt  pasta_container  root  sbin  sys  usr\ndev  home  media   opt  proc             run   srv   tmp  var\n/ # ls -ld /pasta_container\ndrwxr-xr-x    2 root     root            40 Nov 15 10:11 /pasta_container\n")])])]),e("p",[o._v("Verificando em outro terminal:")]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("[marcos@localhost ~]$ ls /tmp\ndropbox-antifreeze-ngXrsG  ssh-BJo2lg5gQv5v  pasta_hospedeiro   systemd-private-2d4a70\n")])])]),e("p",[o._v("A partir da versão 17.06 o Docker começou a utilizar o parâmeto "),e("em",[o._v("--mount")]),o._v(" que é mais descritivo. E esta sintaxe deve ser adotada. Assim, o comando:")]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("sudo docker run -v /pasta/pasta_hospedeiro:/pasta_container \\\n                 --name=nome-container \\\n                 -it nome_imagem [comando_container]\n")])])]),e("p",[o._v("Deverá ser substituído por:")]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("sudo docker run --mount type=bind,source=/pasta/pasta_hospedeiro,target=/pasta_container \\\n                --name=nome-container \\\n                -it nome_imagem [comando_container]\n")])])]),e("p",[o._v("Exemplo:")]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("sudo docker run --mount type=bind,source=/home/marcos/docker.images/bind/,target=/pasta_container \\\n                --name=alpine_sandbox-07 \\\n                -it alpine /bin/ash\n")])])]),e("p",[o._v("(executando o container)")]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("marcos@localhost ~]$ sudo docker run --mount type=bind,source=/home/marcos/docker.images/bind/,target=/pasta_container \\\n>                 --name=alpine_sandbox-07 \\\n>                 -it alpine /bin/ash\n/ # ls /pasta_container/\nfreeplane-icon.png  freeplane_logo.jpg\n/ #\n")])])]),e("p",[o._v("(verificando na pasta local)")]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("[marcos@localhost ~]$ ls /home/marcos/docker.images/bind/\nfreeplane-icon.png  freeplane_logo.jpg\n[marcos@localhost ~]$ \n")])])]),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[o._v("WARNING")]),o._v(" "),e("p",[o._v("A ligação de pastas locais ao container, torna-o menos portátil, visto que implica na existencia da mesma estrutura de arquivos na máquina host.")])]),o._v(" "),e("h2",{attrs:{id:"objeto-volume"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#objeto-volume"}},[o._v("#")]),o._v(" Objeto Volume")]),o._v(" "),e("p",[o._v("O volume pode ser criado com o compartilhamento de pastas durante a inicialização de um container com a chamada a "),e("em",[o._v("RUN")]),o._v(" ou mesmo com o comando VOLUME em um dockerfile. Mas também, pode ser criado sem que esteja associado a qualquer container.")]),o._v(" "),e("h2",{attrs:{id:"o-comando-volume"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#o-comando-volume"}},[o._v("#")]),o._v(" O comando VOLUME")]),o._v(" "),e("p",[o._v("Para gerenciar a criação de volumes existe o comando "),e("em",[o._v("volume")]),o._v(" com os seguintes parâmetros:")]),o._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[o._v("Comando")]),o._v(" "),e("th",{staticStyle:{"text-align":"left"}},[o._v("Descrição")])])]),o._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[o._v("create")]),o._v(" "),e("td",{staticStyle:{"text-align":"left"}},[o._v("Cria um volume")])]),o._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[o._v("inspect")]),o._v(" "),e("td",{staticStyle:{"text-align":"left"}},[o._v("Lista informações sobre um ou mais volumes")])]),o._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[o._v("ls")]),o._v(" "),e("td",{staticStyle:{"text-align":"left"}},[o._v("Lista os volumes criados")])]),o._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[o._v("prune")]),o._v(" "),e("td",{staticStyle:{"text-align":"left"}},[o._v("Remove todos os volumes locais não utilizados")])]),o._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[o._v("rm")]),o._v(" "),e("td",{staticStyle:{"text-align":"left"}},[o._v("Remove um ou mais volumes")])])])]),o._v(" "),e("h3",{attrs:{id:"criando-um-volume"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#criando-um-volume"}},[o._v("#")]),o._v(" Criando um volume")]),o._v(" "),e("p",[o._v("Para criar um volume chamado docker01.vol:")]),o._v(" "),e("p",[e("code",[o._v("sudo docker volume create nome_volume")])]),o._v(" "),e("p",[o._v("Exemplo:")]),o._v(" "),e("p",[e("code",[o._v("sudo docker volume create docker01.vol")])]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("[marcos@localhost ~]$ sudo docker volume create docker01.vol\ndocker01.vol\n")])])]),e("h3",{attrs:{id:"inspecionando-o-volume-criado"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#inspecionando-o-volume-criado"}},[o._v("#")]),o._v(" Inspecionando o volume criado")]),o._v(" "),e("p",[o._v("Para ler as iformações referentes ao volume chamado docker01.vol:")]),o._v(" "),e("p",[e("code",[o._v("sudo docker volume inspect docker01.vol")])]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v('[marcos@localhost ~]$ sudo docker volume inspect docker01.vol\n[\n    {\n        "CreatedAt": "2019-11-15T11:02:09-02:00",\n        "Driver": "local",\n        "Labels": {},\n        "Mountpoint": "/var/lib/docker/volumes/docker01.vol/_data",\n        "Name": "docker01.vol",\n        "Options": {},\n        "Scope": "local"\n    }\n]\n')])])]),e("h3",{attrs:{id:"listando-os-volume-de-um-host"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#listando-os-volume-de-um-host"}},[o._v("#")]),o._v(" Listando os volume de um host")]),o._v(" "),e("p",[o._v("Para listar os volumes existentes no servidor:")]),o._v(" "),e("p",[e("code",[o._v("sudo docker volume ls")])]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("[marcos@localhost ~]$ sudo docker volume ls\nDRIVER              VOLUME NAME\nlocal               226d88056414e07c663082f2cae3010cdb86a635a8fe84e513d645efa49a67b8\nlocal               798f57d1a9f44a6b4c5193921c87a181663c140bad761d2fc8339c0d6dcb1b31\nlocal               docker01.vol\nlocal               dados_oper.vol\n")])])]),e("h3",{attrs:{id:"removendo-volumes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#removendo-volumes"}},[o._v("#")]),o._v(" Removendo volumes")]),o._v(" "),e("p",[o._v("Use o parametro "),e("em",[o._v("prune")]),o._v(" para remover todos os volumes que não estão em uso:")]),o._v(" "),e("p",[e("code",[o._v("sudo docker volume prune")])]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("[marcos@localhost ~]$ sudo docker volume prune\nWARNING! This will remove all local volumes not used by at least one container.\nAre you sure you want to continue? [y/N] y\nDeleted Volumes:\ndocker.vol\ndados_oper.vol\n\nTotal reclaimed space: 0B\n[marcos@localhost ~]$ \n")])])]),e("p",[o._v("Ou use "),e("em",[o._v("rm")]),o._v(" para remover nominalmente um ou mais volumes:")]),o._v(" "),e("p",[e("code",[o._v("sudo docker volume rm docker02.vol")])]),o._v(" "),e("h2",{attrs:{id:"volumes-anexados"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#volumes-anexados"}},[o._v("#")]),o._v(" Volumes Anexados")]),o._v(" "),e("h3",{attrs:{id:"anexando-um-volume"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#anexando-um-volume"}},[o._v("#")]),o._v(" Anexando um volume")]),o._v(" "),e("p",[o._v("Ao criar um container é possível anexar um volume existente:")]),o._v(" "),e("p",[e("code",[o._v("sudo docker container create --name=nome-container -it --mount source=nome-volume,target=/nome-pasta-container nome-imagem")])]),o._v(" "),e("p",[e("code",[o._v("sudo docker container create --name=volume-sandbox -it --mount source=docker02.vol,target=/meu_volume alpine")])]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("marcos@localhost ~]$ sudo docker volume create docker03.vol\ndocker03.vol\n[marcos@localhost ~]$ sudo docker container create --name=volume-sandbox -it --mount source=docker03.vol,target=/meu_volume  alpine /bin/ash\ne247e0d455f0459a10eb9c3045a6e52ad75468097e2e8b6a96e0c6f8d4d29f39\n")])])]),e("p",[o._v("Inspecionando o container para verficar o volume anexado:")]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v('marcos@localhost ~]$ docker container inspect volume-sandbox\n        ... (linhas retiradas)\n        "Mounts": [\n            {\n                "Type": "volume",\n                "Name": "docker03.vol",\n                "Source": "/var/lib/docker/volumes/docker03.vol/_data",\n                "Destination": "/meu_volume",\n                "Driver": "local",\n                "Mode": "z",\n                "RW": true,\n                "Propagation": ""\n            }\n        ...    \n')])])]),e("h3",{attrs:{id:"compartilhando-arquivos-entre-conteineres"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#compartilhando-arquivos-entre-conteineres"}},[o._v("#")]),o._v(" Compartilhando arquivos entre contêineres")]),o._v(" "),e("p",[o._v("Para testar o compartilhamento, serão usados dois contêineres (volume-sandbox-01, volume-sandbox-02) e um volume (docker04.vol):")]),o._v(" "),e("ul",[e("li",[o._v("Criando o volume, os contêineres e iniciando-os:")])]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[o._v("\tsudo docker volume create docker04.vol\n\tsudo docker container create --name=volume-sandbox-01 -it \\\n\t\t--mount source=docker04.vol,target=/meu_volume  alpine\n\tsudo docker container create --name=volume-sandbox-02 -it \\\n\t\t--mount source=docker04.vol,target=/meu_volume  alpine\n\tsudo docker container start volume-sandbox-01\n\tsudo docker container start volume-sandbox-02\n")])])]),e("ul",[e("li",[o._v("Conectando ao primeiro container. Criando um arquivo texto "),e("em",[o._v("leiame.txt")]),o._v(":")])]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[o._v('\t[marcos@localhost ~]$ sudo docker exec -it volume-sandbox-01 /bin/ash\n\t/ # ls\n\tbin         dev         etc         home        lib         media       meu_volume  mnt         opt         proc        root        run         sbin        srv         sys         tmp         usr         var\n\t/ # cd meu_volume/\n\t/meu_volume # echo "Fui criado a partir de volume-sandbox-01" > leiame.txt\n\t/meu_volume # ls\n\tleiame.txt\n')])])]),e("ul",[e("li",[o._v("Conectando ao segundo container. Verificando a existência do "),e("em",[o._v("leiame.txt")]),o._v(" na pasta meu_volume:")])]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[o._v("\t[marcos@localhost ~]$ sudo docker exec -it volume-sandbox-02 /bin/ash\n\t/ # ls\n\tbin         dev         etc         home        lib         media       meu_volume  mnt         opt         proc        root        run         sbin        srv         sys         tmp         usr         var\n\t/ # cat meu_volume/leiame.txt \n\tFui criado a partir de volume-sandbox-01\n")])])]),e("h3",{attrs:{id:"copiando-arquivos-do-hospedeiro-para-o-volume"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#copiando-arquivos-do-hospedeiro-para-o-volume"}},[o._v("#")]),o._v(" Copiando arquivos do hospedeiro para o volume")]),o._v(" "),e("p",[o._v("Copiando o arquivo "),e("em",[o._v("arquivo-do-host.txt")]),o._v(" do hospdeiro para a pasta "),e("em",[o._v("meu_volume")]),o._v(" no container "),e("em",[o._v("volume-sandbox-01")]),o._v(":")]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("`sudo docker container cp arquivo-do-host.txt volume-sandbox-01:/meu_volume`\n")])])]),e("h2",{attrs:{id:"verificando-o-ponto-de-montagem-do-volume-criado"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#verificando-o-ponto-de-montagem-do-volume-criado"}},[o._v("#")]),o._v(" Verificando o ponto de montagem do volume criado")]),o._v(" "),e("p",[e("code",[o._v("sudo docker volume inspect docker04.vol")])]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v('[marcos@localhost ~]$ sudo docker volume inspect docker04.vol\n[\n    {\n        "CreatedAt": "2019-11-15T12:36:13-02:00",\n        "Driver": "local",\n        "Labels": {},\n        "Mountpoint": "/var/lib/docker/volumes/docker04.vol/_data",\n        "Name": "docker04.vol",\n        "Options": {},\n        "Scope": "local"\n    }\n]\n[marcos@localhost ~]$ sudo ls /var/lib/docker/volumes/docker04.vol/_data\narquivo-do-host.txt  leiame.txt\n')])])]),e("p",[o._v("Os arquivos "),e("em",[o._v("arquivo-do-host.txt")]),o._v(" e "),e("em",[o._v("leiame.txt")]),o._v(" estão na pasta _/var/lib/docker/volumes/docker04.vol/"),e("em",[o._v("data")])]),o._v(" "),e("h2",{attrs:{id:"criando-link-simbolico-para-o-ponto-de-montagem"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#criando-link-simbolico-para-o-ponto-de-montagem"}},[o._v("#")]),o._v(" Criando Link simbólico para o Ponto de Montagem")]),o._v(" "),e("p",[o._v("O docker possui plugins para permitir que o ponto de montagem seja alterado. Podem ser usados links simbólicos para tornar o acesso aos pontos de montagem mais simples.")]),o._v(" "),e("ul",[e("li",[o._v("Crie uma pasta para receber os links para seus volumes")])]),o._v(" "),e("p",[e("code",[o._v("sudo mkdir home/marcos/docker.images/volume/")])]),o._v(" "),e("ul",[e("li",[o._v("Crie dentro da mesma, uma pasta com o nome do volume desejado")])]),o._v(" "),e("p",[e("code",[o._v("sudo mkdir /home/marcos/docker.images/volume/docker04.vol")]),o._v(" "),e("code",[o._v("sudo mkdir /home/marcos/docker.images/volume/docker04.vol/dados")])]),o._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[o._v("Fique Atento")]),o._v(" "),e("p",[o._v("Se já existem arquivos no volume, copie-os para a pasta criada e remova-os do destino!")])]),o._v(" "),e("ul",[e("li",[o._v("Crie o link simbólico")])]),o._v(" "),e("p",[e("code",[o._v("sudo ln -s /home/marcos/docker.images/volume/docker04.vol /var/lib/docker/volumes/docker04.vol/_data")])]),o._v(" "),e("p",[o._v("sudo ln -s /home/marcos/docker.images/volume/docker04.vol/dados /var/lib/docker/volumes/docker04.vol/_data")]),o._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[o._v("[marcos@localhost ~]$ sudo ln -s /home/marcos/docker.images/volume/docker04.vol/dados /var/lib/docker/volumes/docker04.vol/_data\n[marcos@localhost ~]$ sudo docker exec -it volume-sandbox-01 /bin/ash\n/ # ls meu_volume/\ndados\n")])])])])}),[],!1,null,null,null);a.default=t.exports}}]);