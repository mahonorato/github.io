(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{434:function(a,t,i){"use strict";i.r(t);var e=i(42),o=Object(e.a)({},(function(){var a=this.$createElement,t=this._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":this.$parent.slotKey}},[t("h2",{attrs:{id:"faturamento"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#faturamento"}},[this._v("#")]),this._v(" Faturamento")]),this._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[this._v("Faturamento Instalação/Ano\n    -- Cria a tabela com os dados     drop table admri2.fat_12M_20180816;     create table admri2.fat_12M_20180816 nologging as       SELECT i.id_cdc            , i.apz            , i.desc_apz            , i.ano_base            , SUM(valor_faturado_kwh) AS fat_12m         FROM admri2.instalacao i        LEFT JOIN  ri_energy_light.fato_consumo_faturamento f                 ON i.id_cdc = to_number(f.id_cdc) AND EXTRACT(YEAR FROM f.ano_mes_referencia) = ano_base       -- WHERE i.id_cdc IN (400301167, 400350494, 410617775)     GROUP BY i.id_cdc, i.apz, i.desc_apz, i.ano_base;  -- Faturamentos não encontrados:    -- 224.539 instalaçoes        select count(*) from admri2.fat_12M_20180816 where fat_12m is null;     select * from admri2.fat_12M_20180816;  -- Cria a tabela com os dados para verificação     drop table admri2.faturamento_12M;     create table admri2.faturamento_12M nologging as       SELECT f.id_cdc            , i.apz            , i.desc_apz            , i.ano_base            , SUM(valor_faturado_kwh) AS fat_12m         FROM ri_energy_light.fato_consumo_faturamento f        INNER JOIN admri2.instalacao i                 ON i.id_cdc = to_number(f.id_cdc) AND EXTRACT(YEAR FROM f.ano_mes_referencia) = ano_base       -- WHERE i.id_cdc IN (400301167, 400350494, 410617775)     GROUP BY f.id_cdc, i.apz, i.desc_apz, i.ano_base;   -- Verifica quantos foram encontrados  select count(*) from admri2.faturamento_12M; -- 618.773   -- Situação das instalações:     select c.id_situacao, count(*)      from ri_energy_light.cdc c        inner join admri2.instalacao i on i.id_cdc = c.id_cdc      group by c.id_situacao;              --    ID_SITUACAO    COUNT(*)         --    00             621879         --    10             219762         --    05                950         --    11                721    -- Instalaçoes que não tem faturamento no ano-base pedido  -- 224.539 Instalações   select count(*) from (     select distinct id_cdc, ano_base from admri2.instalacao     minus      select id_cdc, ano_base      from (SELECT i.id_cdc, i.ano_base         FROM ri_energy_light.fato_consumo_faturamento f        INNER JOIN admri2.instalacao i                 ON i.id_cdc = to_number(f.id_cdc) AND EXTRACT(YEAR FROM f.ano_mes_referencia) = ano_base)     );          select distinct id_cdc, ano_base from admri2.instalacao i  ;  select distinct to_number(id_cdc) from admri2.instalacao minus  select distinct to_number(id_cdc) from faturamento_12M  ;  select distinct to_number(id_cdc) from admri2.instalacao minus  select id_cdc from ri_energy_light.cdc;\nConsumo\n    Usar sempre o consumo faturado\n")])])])])}),[],!1,null,null,null);t.default=o.exports}}]);